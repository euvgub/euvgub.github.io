<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<title>Экспорт данных в системы технического анализа с использованием внешних программ</title>
<meta name="GENERATOR" content="WinCHM">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">



<STYLE type=text/css>

ADDRESS {font-style:normal;  padding-left: 20px; margin: 0px 0px 25pt 5pt; font-size: 9pt; color:#000000; font-style:normal; font-weight: normal; display:list-item; list-style-type:none; list-style-position: outside; list-style-image:url('template/icon-popup.gif');}

ADDRESS P {font-style:normal;  padding-left: 20px; margin: 0px 0px 5pt -15pt; font-size: 9pt; color:#000000; font-style:normal; font-weight: normal; display:list-item; list-style-type:none; list-style-position: outside; list-style-image:url('template/icon-popup.gif');}

MENU { font-size: 12pt; font-family:Verdana;  line-height:100%; margin:0px 0px 0px 20pt; list-style-type:none; list-style-position: outside; list-style-image:url('template/blt-link_black.gif'); }

BODY {font-family: Arial; font-size: 12pt; color:#000000; background-color: #fbfbfb; line-height: 1.3; margin:0pt 5pt 10pt 5pt;}

A {color: #16A9D3;}
P  {font-family:Arial; font-size:12pt; margin-top:0px; margin-bottom:12pt;}

IMG { margin:0pt 0pt 0pt auto; }

UL { font-family: Arial; font-size: 12pt; margin:12px 0px 12px 20px; list-style-type:disc; list-style-image:url('template/blt-li.gif'); } 
OL {font-family: Arial; font-size: 12pt; font-weight: bold; margin-top:12pt; margin-bottom:6pt; margin-left:20pt; type: bold;}
LI { margin-bottom: 8px; }
LI OL { margin-left: 25px; }
LI UL { margin-left: 25px; list-style-image:url('template/blt-link_black.gif'); }

SPAN {font-weight: normal;}

DD OL { font:12pt Verdana; font-style:normal; font-weight: bold; margin-left: 35px; }

H1 { font-size: 28pt; font-family:Verdana; color:#000000; font-style:normal; line-height:110%; margin-top:20pt; margin-bottom:26pt; text-decoration:none; font-weight: bold; margin-right:auto; margin-left:auto;}
H2 { font-size: 20pt; font-family:Verdana; color:#000000; font-style:normal; line-height:110%; margin-top:20pt; margin-bottom:6pt; text-decoration:none; font-weight: bold; margin-left:auto; padding: 0.5ex 0; }
H3 { font-size: 14pt; font-family:Verdana; color:#000000; font-style:normal; line-height:95%; margin-top:20pt; margin-bottom:6pt; margin-left: auto;}
H4 { font-size: 11pt; font-family:Verdana; color:#000000; font-style:normal; line-height:95%; margin-top:16pt; margin-bottom:6pt; margin-left: auto;}

TABLE { border-collapse: collapse; margin-bottom:20pt; }
TH { font-size: 10pt; border-top: none; border-bottom:#000000 3px solid; padding:15pt 5pt 5px 0px; color:#000000; font-family:Verdana; font-style:normal; font-weight: bold; text-align:left; }
TD { font-size:10pt; border-top: 0pt; font-family:Arial; border-bottom:#000000 1px solid; padding:4pt 5px 12pt 0px;  line-height:120%; }
TD P {font-family: Arial; font-size: 10pt; margin-top:6pt;}
TD.plain 	{margin:0px 0px 0px 0px; border-top: 0px; border-bottom:0px; padding:0px 0px 0px 0px; font-size:100%; line-height:100%;}
TD.array	{ border: 1px solid #D4D4D4; text-align: center; width: 90px;}
TD.pic	{ padding:0px 0px 0px 0px; }
TD.line1          { background-color:#000000; }
TD.line2          { background-color:#000000; }
TD UL {font-family: Arial; font-size: 10pt; margin:0px 0px 0px 20px; line-height:120%;}
TD UL LI {font-family: Arial; font-size: 10pt; margin-bottom: 0px; list-style-image:url('template/blt-link_black.gif');}

TD H4	{line-height: 100%; margin-top: 8px; margin-bottom: 0px;}

DL	{ padding-left:35px; margin-left: 30px; margin-bottom: 35px;}
DD	{ padding-left:8px; color:#000000; margin: 8px 8px 8px 0px; font:12pt Verdana; font-style:normal; font-weight: bold; border-left: #000000 4px solid; margin-bottom:18pt; }
DD P	{font:12pt Verdana; font-style:normal; font-weight: bold; }

PRE	{ background-color:#F2F2F2; margin-left: 35px; margin-bottom: 20px; border-style:none; border-top-style: none; border-bottom-style: none; padding:8px 8px 8px 8px; font: 10pt Courier New; line-height:160%;}

.title {display: inline; background:#FbFbFb; margin-left: 0px; border-style:solid; border-color:#D4D4D4; border-width: 1px 1px 0px 4px; padding:8px 8px 6px 12px; color:#19A788; font-weight:bold;}
.hlt { background:#FFFFFF; margin-left: 0px; border-style:solid; border-color:#D4D4D4; border-width: 1px 2px 1px 4px; padding:15px 8px 15px 46px;}

STRONG { font-weight: bold;}
.logo	{ position: relative; top:-45px; float: right; width: 100px; margin:10px 10px 10px 10px; }
.mark	{ font: 10pt Verdana; color: #5EB28E; }
.defn	{ font: 15px Trebuchet MS; margin:12px 0px 12px 50px; }
.copyright {font: 12pt Trebuchet MS; font-style:normal; color:#A2A2A2; margin-top: 50px;}
.comment	{ font-size: 10pt; font-family: Verdana; }
</STYLE>

<meta name=GENERATOR content="MSHTML 8.00.6001.18812"></head>

<body aLink=#19a788 link=#007cae vLink=#8d4194>
<H1 style="MARGIN-TOP: 10pt">Экспорт данных в системы технического анализа с использованием внешних программ</H1>
<P><FONT size=2 face=Arial>
<MENU>
  <LI><A href="#subt1">Назначение</A>
  <LI><A href="#subt2">Использование программы DDE2MS</A>
  <LI><A href="#subt3">Использование программы MetaServer RT </A>
<LI><A href="#subt4">Настройка </A>
</LI></MENU>

<P> </P>
<a name="subt1"></a>
<H2>Назначение </H2>
<P>Использование получаемых системой QUIK данных для 
оперативного технического анализа в программе Equis MetaStock в случае, 
если использование встроенных средств экспорта невозможно.</P>
<P>Существует два распространенных способа экспорта 
информации – с использованием программ DDE2MS и MetaServer RT. Обе программы 
используют следующую схему передачи информации:</P>

<P><IMG src="EXPORT_TA40.gif"></P>

<UL>
  <LI>Из QUIK 
  выводятся данные из <A href="ch3_1.html"> Таблицы текущих 
  торгов</A> в Microsoft Excel, используя механизм DDE, 
  <LI>DDE2MS или MetaServer RT забирают обновляемые данные 
  из Microsoft Excel и передают их в MetaStock.</LI></UL>
<P>Программа DDE2MS, как нам показалось, более удобна в 
работе и настройке, является более предсказуемой, но, в отличие от MetaServer 
RT, демо-версия которого может закачивать данные по двум инструментам, DDE2MS может 
работать только с одной. Вы можете выбрать любой из этих вариантов.</P>

<a name="subt2"></a><H2>Использование программы DDE2MS</H2>
<OL>
  <LI><SPAN>Запустите программу DDE2MS (она поставляется в виде 
  автономного exe-файла, полностью готового к работе). </SPAN>
  <LI><SPAN>Заполните необходимые для работы параметры:  
  <UL>
    <LI>В поле «Path» укажите полный путь к созданному 
    источнику данных MetaStock (например, «C:\MetaStock Data\SBER»). 
    <LI>В поле «Symbol» укажите имя источника данных (в 
    нашем примере это будет «SBER»). 
    <LI>В поле «Interval» выберите «1». 
    <LI>В поле «Server» введите «Excel». 
    <LI>В поле «Topic» определяются Книга и Лист MS Excel, 
    из которых будут забираться данные, в формате вида 
    «[имя_книги.xls]имя_листа», например: «[Книга1.xls]Лист1». 
    <LI>В полях «Item-Last Price» (цена последней сделки) и 
    «Item-Volume» (количество инструментов в последней сделке) введите адреса ячеек MS 
    Excel в формате «RxCy», из которых надо брать соответствующие данные, где 
    «x»-номер строки, «y»-номер столбца (цифрами).</LI></UL></SPAN>
  <LI><SPAN>Нажмите на кнопку «Start». Если DDE2MS найдет 
  требуемые для работы данные, то появится таблица с текущими значениями OHLCV, 
  название кнопки изменится на «Stop» и поля ввода станут неактивными. В 
  противном случае будет показано сообщение об ошибке.</SPAN></LI></OL>

<a name="subt3"></a>
<H2>Использование программы MetaServer RT</H2>
<OL>
  <LI><SPAN>Запустите программу MetaServerRT. </SPAN>
  <LI><SPAN>Проверьте, имеется ли созданный в MetaStock источник 
  (в примере - «SBER») в списке доступных источников. Если этого источника 
  нет, выберите пункт меню «Symbol-Add new» и опишите созданный Вами источник 
  (SBER). </SPAN>
  <LI><SPAN>Выберите строку таблицы, соответствующую новому 
  источнику данных (содержащую его наименование в столбце «TS/MS Symbol») и 
  двойным нажатием левой кнопки мыши на строке откройте окно с настройками 
  параметров источника. </SPAN>
  <LI><SPAN>В открывшемся окне выполните следующие действия: 
  <UL>
    <LI>в поле «Global Server/MetaStock Symbol» введите имя 
    источника данных, 
    <LI>в поле «DDE» наберите «Excel».</LI></UL></SPAN>
  <LI><SPAN>Перейдите на вкладку «Easy-Setup tools»: 
  <UL>
    <LI>в поле «Topic» укажите книгу и лист MS Excel с 
    данными из QUIK, в формате «[имя_книги.xls]имя_листа», например: 
    «[Книга1.xls]Лист1». 
    <LI>в поле «Item» введите адрес ячейки с данными, 
    формата «RxCy», где «x» - номер строки, «y» - номер столбца, например: 
    «R1C1».</LI></UL></SPAN>
  <LI><SPAN>Нажмите на кнопки «Set». </SPAN>
  <LI><SPAN>Перейдите обратно на вкладку 
  «Tradestation/MetaStock», и поставьте все флажки («галочки»). Нажмите кнопку 
  «Ok». </SPAN>
  <LI><SPAN>Нажмите на панели управления программы MetaServerRT 
  зелёную кнопку (с подсказкой «Start all instruments»). Если настройки были 
  сделаны правильно и данные по инструменту доступны, то в строке таблицы с 
  настраиваемым источником данных параметр «*» должен принять значение «+».</SPAN></LI></OL>

<a name="subt4"></a>
<H2>Настройка</H2>
<P>Настройка 
источника данных для MetaStock аналогична настройкам при использовании 
встроенных средств экспорта (см. п. <A href="ch6_4.html">Настройка программы 
Equis MetaStock</A>).</P>

<P>
<DL>
  <DD>Рекомендации: <P>Для того, чтобы MetaStock правильно воспринимал 
  дробные числа, в региональных настройках Windows поставьте в качестве 
  разделителя для дробных чисел «.» (точка), а не «,» (запятая), иначе данные не 
  будут передаваться правильно.</P>    
         
                
  
</DD></DL>
</FONT></P>

<P><DIV class=copyright>Руководство пользователя QUIK © ARQA Technologies / <A 
href="http://arqatech.com/ru/products/quik/" target="_blank">www.arqatech.com/ru/products/quik/ </A></DIV>
</body>
