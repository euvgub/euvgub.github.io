<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<HTML><HEAD><title>Экспорт данных через DDE-сервер</title>
<META name=GENERATOR content="MSHTML 8.00.6001.18812">
<META content="text/html; charset=utf-8" http-equiv=Content-Type>

<STYLE type=text/css>

ADDRESS {font-style:normal;  padding-left: 20px; margin: 0px 0px 25pt 5pt; font-size: 9pt; color:#000000; font-style:normal; font-weight: normal; display:list-item; list-style-type:none; list-style-position: outside; list-style-image:url('template/icon-popup.gif');}

ADDRESS P {font-style:normal;  padding-left: 20px; margin: 0px 0px 5pt -15pt; font-size: 9pt; color:#000000; font-style:normal; font-weight: normal; display:list-item; list-style-type:none; list-style-position: outside; list-style-image:url('template/icon-popup.gif');}

MENU { font-size: 12pt; font-family:Verdana;  line-height:100%; margin:0px 0px 0px 20pt; list-style-type:none; list-style-position: outside; list-style-image:url('template/blt-link_black.gif'); }

BODY {font-family: Arial; font-size: 12pt; color:#000000; background-color: #fbfbfb; line-height: 1.3; margin:0pt 5pt 10pt 5pt;}

A {color: #16A9D3;}
P  {font-family:Arial; font-size:12pt; margin-top:0px; margin-bottom:12pt;}

IMG { margin:0pt 0pt 0pt auto; }

UL { font-family: Arial; font-size: 12pt; margin:12px 0px 12px 20px; list-style-type:disc; list-style-image:url('template/blt-li.gif'); } 
OL {font-family: Arial; font-size: 12pt; font-weight: bold; margin-top:12pt; margin-bottom:6pt; margin-left:20pt; type: bold;}
LI { margin-bottom: 8px; }
LI OL { margin-left: 25px; }
LI UL { margin-left: 25px; list-style-image:url('template/blt-link_black.gif'); }

SPAN {font-weight: normal;}

DD OL { font:12pt Verdana; font-style:normal; font-weight: bold; margin-left: 35px; }

H1 { font-size: 28pt; font-family:Verdana; color:#000000; font-style:normal; line-height:110%; margin-top:20pt; margin-bottom:26pt; text-decoration:none; font-weight: bold; margin-right:auto; margin-left:auto;}
H2 { font-size: 20pt; font-family:Verdana; color:#000000; font-style:normal; line-height:110%; margin-top:20pt; margin-bottom:6pt; text-decoration:none; font-weight: bold; margin-left:auto; padding: 0.5ex 0; }
H3 { font-size: 14pt; font-family:Verdana; color:#000000; font-style:normal; line-height:95%; margin-top:20pt; margin-bottom:6pt; margin-left: auto;}
H4 { font-size: 11pt; font-family:Verdana; color:#000000; font-style:normal; line-height:95%; margin-top:16pt; margin-bottom:6pt; margin-left: auto;}

TABLE { border-collapse: collapse; margin-bottom:20pt; }
TH { font-size: 10pt; border-top: none; border-bottom:#000000 3px solid; padding:15pt 5pt 5px 0px; color:#000000; font-family:Verdana; font-style:normal; font-weight: bold; text-align:left; }
TD { font-size:10pt; border-top: 0pt; font-family:Arial; border-bottom:#000000 1px solid; padding:4pt 5px 12pt 0px;  line-height:120%; }
TD P {font-family: Arial; font-size: 10pt; margin-top:6pt;}
TD.plain 	{margin:0px 0px 0px 0px; border-top: 0px; border-bottom:0px; padding:0px 0px 0px 0px; font-size:100%; line-height:100%;}
TD.array	{ border: 1px solid #D4D4D4; text-align: center; width: 90px;}
TD.pic	{ padding:0px 0px 0px 0px; }
TD.line1          { background-color:#000000; }
TD.line2          { background-color:#000000; }
TD UL {font-family: Arial; font-size: 10pt; margin:0px 0px 0px 20px; line-height:120%;}
TD UL LI {font-family: Arial; font-size: 10pt; margin-bottom: 0px; list-style-image:url('template/blt-link_black.gif');}

TD H4	{line-height: 100%; margin-top: 8px; margin-bottom: 0px;}

DL	{ padding-left:35px; margin-left: 30px; margin-bottom: 35px;}
DD	{ padding-left:8px; color:#000000; margin: 8px 8px 8px 0px; font:12pt Verdana; font-style:normal; font-weight: bold; border-left: #000000 4px solid; margin-bottom:18pt; }
DD P	{font:12pt Verdana; font-style:normal; font-weight: bold; }

PRE	{ background-color:#F2F2F2; margin-left: 35px; margin-bottom: 20px; border-style:none; border-top-style: none; border-bottom-style: none; padding:8px 8px 8px 8px; font: 10pt Courier New; line-height:160%;}

.title {display: inline; background:#FbFbFb; margin-left: 0px; border-style:solid; border-color:#D4D4D4; border-width: 1px 1px 0px 4px; padding:8px 8px 6px 12px; color:#19A788; font-weight:bold;}
.hlt { background:#FFFFFF; margin-left: 0px; border-style:solid; border-color:#D4D4D4; border-width: 1px 2px 1px 4px; padding:15px 8px 15px 46px;}

STRONG { font-weight: bold;}
.logo	{ position: relative; top:-45px; float: right; width: 100px; margin:10px 10px 10px 10px; }
.mark	{ font: 10pt Verdana; color: #5EB28E; }
.defn	{ font: 15px Trebuchet MS; margin:12px 0px 12px 50px; }
.copyright {font: 12pt Trebuchet MS; font-style:normal; color:#A2A2A2; margin-top: 50px;}
.comment	{ font-size: 10pt; font-family: Verdana; }
</STYLE>

<meta name=GENERATOR content="MSHTML 8.00.6001.18812"></head>
<body aLink=#19a788 link=#007cae vLink=#8d4194>
<H1 style="MARGIN-TOP: 10pt">Экспорт данных через DDE-сервер</H1>
<P><FONT size=2 face=Arial>
<ADDRESS>Кнопка <IMG src="b-excel.gif"></ADDRESS>
<MENU>
  <LI><A href="#subt1">Назначение</A> 
  <LI><A href="#subt2">Использование</A> </LI></MENU>

<P> </P>
<A name=subt1></A>
<H2>Назначение </H2>
<P>Передача данных из таблиц системы QUIK во внешние программы, например, в Microsoft Excel. Экспорт осуществляется в формате XLTABLE через метод обмена данными DDE.</P>
<DL>
    <DD>Обращаем внимание, что при использовании фильтрации в таблицах некорректно экспортируются данные через DDE-сервер из таблиц, в которых возможны вставки-удаления строк в начало и середину таблицы (например, Таблицы позиций по деньгам и инструментам).</DD>
  </DL>

<A name=subt2></A>
<H2>Использование</H2>
<OL>
  <LI><SPAN>Перед тем, как настраивать экспорт данных, необходимо 
  настроить DDE-сервер. При выводе данных в MS Excel необходимо предварительно 
  открыть программу и загрузить в нее файл, в который будет 
  осуществляться передача данных (если настройка «Запускать приложение DDE сервера автоматически» не 
  включена). 
  <P align=left><IMG src="UseExcel70.gif"></P></SPAN>
  <LI><SPAN>Функция экспорта данных из активной таблицы может быть вызвана одним из 
  следующих способов: 
  <UL>
    <LI>нажатием кнопки <IMG src="b-excel.gif"> на панели инструментов; 
    <LI>выбором пункта меню <STRONG>Действия/Вывод через DDE сервер...</STRONG>, 
   <LI>нажатием нажатием клавиш «Ctrl»+«L»,
    <LI>выбором пункта контекстного меню «Вывод через DDE сервер...».</LI></UL></SPAN>
  <LI><SPAN>Назначение полей окна настройки экспорта «Вывод через DDE сервер...»: 
  <P>
  <TABLE>
    <TBODY>
    <TR>
      <TH>Поле</TH>
      <TH width="75%">Значение</TH></TR>
    <TR>
      <TD>Название таблицы </TD>
      <TD width="75%">Название таблицы QUIK, являющейся источником 
данных</TD></TR>
    <TR>
      <TD>DDE-сервер</TD>
      <TD width="75%">Наименование DDE-сервера. Нажатием кнопки «По умолчанию» 
        возвращается значение «excel» </TD></TR>
    <TR>
      <TD>Рабочая книга </TD>
      <TD width="75%">Наименование файла, в 
        который будет выведена информация из таблицы. Кнопка «…» справа 
        позволяет указать существующий файл, расположенный на диске, и путь до 
        него. Если выбран DDE-сервер «excel», то файл рабочей книги должен иметь расширение 
        .xls или .xlsx.</TD></TR>
    <TR>
      <TD>Лист</TD>
      <TD width="75%">Наименование листа, на который будет перенесена 
        информация из таблицы</TD></TR>
    <TR>
      <TD>Запускать приложение DDE сервера 
      автоматически</TD>
      <TD width="75%">Активизировать функцию 
        автоматического открытия выбранной рабочей книги в MS Excel при старте 
        экспорта. Флажок активен, если в качестве DDE сервера выбран 
        «excel».Поля «Рабочая книга» и «Лист» могут 
        быть не заполнены.</TD></TR>

    <TR>
      <TD>Левый верхний угол 
        <UL>
          <LI>Ряд 
          <LI>Колонка</LI></UL></TD>
      <TD width="75%">Координаты начальной ячейки для передачи данных 
        <UL>
          <LI>Номер строки, считая сверху 
          <LI>Номер колонки, считая слева</LI></UL></TD></TR>
    <TR>
      <TD>Выводить таблицу, начиная со строки</TD>
      <TD width="75%"> Выводить строки таблицы, начиная с заданного 
        номера. Может применяться для сокращения времени повторного вывода 
        таблиц, например Таблицы обезличенных сделок</TD></TR>
    <TR>
      <TD>Вывод после создания</TD>
      <TD width="75%">Активизировать функцию экспорта данных сразу после 
        загрузки файла с конфигурацией таблиц, например, при открытии программы 
        QUIK</TD></TR>
    <TR>
      <TD>Вывод при нажатии Ctrl+Shift+L</TD>
      <TD width="75%">При установленном флажке экспорт из таблицы может быть 
        активизирован нажатием приведенной комбинации клавиш</TD></TR>
    <TR>
      <TD>С заголовками строк</TD>
      <TD width="75%">Выводить в качестве первой колонки заголовки строк 
        таблицы QUIK<BR></TD></TR>
    <TR>
      <TD>С заголовками столбцов </TD>
      <TD width="75%">Выводить в качестве первой строки заголовки столбцов 
        таблицы QUIK</TD></TR>
    <TR>
      <TD>Формальные заголовки </TD>
      <TD width="75%">Выводить в качестве заголовков их системные (служебные) 
        наименования. Может использоваться для удобства программирования.</TD></TR>
    <TR>
      <TD>Выводить пустые ячейки вместо нулей</TD>
      <TD width="75%">Оставлять пустыми (не заполнять числовыми значениями) 
        ячейки, содержащие нулевые значения. Данное свойство полезно при 
        графическом отображении рядов данных средствами MS Excel, для 
        предотвращения «провалов» линий графика в местах, где данные 
        отсутствуют (не были получены с сервера).</TD></TR></TBODY></TABLE></P></SPAN>
  <LI><SPAN>Нажатие кнопки «Начать вывод» приводит к старту 
  динамического вывода данных из указанной таблицы в файл экспорта. При нажатии 
  с установленным флагом «Запускать приложение DDE сервера автоматически» осуществляется попытка запустить MS Excel и 
  загрузить в него указанную книгу и лист. Если MS Excel не 
  запущен, то имя книги должно быть указано с 
  полным путем к существующему файлу либо поле «Рабочая книга» должно быть не 
  заполнено.  <P>В MS Excel имена созданных, но еще не сохранённых книг задаются без 
  расширения, например, «Книга1». Если в качестве рабочей книги указано имя без 
  расширения, то сначала будет выполнена попытка найти такую книгу среди уже 
  открытых в MS Excel, а если она не найдена, то создать новую книгу. При этом 
  совпадение имени с указанным в поле «Рабочая книга» не гарантируется.<P>Если 
  имя книги не указано, то при запуске MS Excel в нем будет создана новая книга. 
  Если не указано имя листа, то в книге сначала ищется лист с названием 
  экспортируемой таблицы (например, «Таблица заявок #2»), а если он не найден, 
  то добавляется новый лист с таким названием. При запуске экспорта в MS Excel 
  из других таблиц без указания имени рабочей книги, будет использоваться эта же 
  рабочая книга. <P>Если в поле «Рабочая книга» указано имя файла без полного 
  пути до него, то происходит поиск файла в текущем рабочем каталоге. При 
  неудачной попытке системой выдается сообщение об ошибке.</P> </SPAN></LI></OL>

  <OL start=5><LI><SPAN>Нажатием кнопки «Остановить вывод» вывод данных из таблицы 
  останавливается. </SPAN>
  <LI><SPAN>Кнопка «Вывести сейчас» предназначена для разового вывода данных. </SPAN>
  <LI><SPAN>Нажатием кнопки «Закрыть» производится закрытие окна настройки экспорта с 
  сохранением произведенных настроек. Если процесс экспорта начат, он будет 
  осуществляться автоматически в фоновом режиме.</SPAN> 
  <LI><SPAN>Нажатие кнопки «Отменить» закрывает окно без сохранения 
  настроек.</SPAN>
<LI><SPAN>Нажатие кнопки «Справка» вызывает справку по данной функции.</SPAN></LI></OL>
<P>
<DL>
  <DD>
  <OL>
    <LI>Когда в MS Excel открыто любое окно для редактирования настроек, данные 
    в его таблицы не поступают, а накапливаются в буфере DDE. В случае 
    длительной занятости Excel передача данных может быть прервана. Время 
    ожидания до разрыва DDE-соединения (занятости MS Excel) регулируется 
    настройками экспорта. 
    <LI>Каждая таблица обладает собственными настройками экспорта данных, 
    поэтому разные таблицы могут экспортировать данные в разные DDE-сервера, 
    файлы, листы или ячейки MS Excel. 
    <LI>Из одной таблицы QUIK возможен экспорт данных только в один DDE-сервер. 
    <LI>В один DDE-сервер можно экспортировать данные из разных таблиц QUIK. 
    Например, в разные ячейки одного листа MS Excel можно выводить данные из 
    разных таблиц QUIK. 
    <LI>    При изменении формата таблицы экспорт данных 
    останавливается и на экран выводится окно настройки экспорта для установки новых параметров 
    для вывода данных. 
    <LI>При выводе данных через DDE не рекомендуется использовать фильтр в таблицах, предназначенных 
    для экспорта. Если в настройках таблицы имеется признак «Пока-зывать нулевые значения», то 
    его рекомендуется включить. 
    <LI>      Вывод данных через DDE 
    происходит в соответствии с сортировкой строк таблицы по умолчанию, 
    а текущая сортировка, используемая в таблице, не учитывается. 
    </LI></OL></DD></DL>
</FONT></P>

<P><DIV class=copyright>Руководство пользователя QUIK © ARQA Technologies / <A 
href="http://arqatech.com/ru/products/quik/" target="_blank">www.arqatech.com/ru/products/quik/ </A></DIV>
</body>
</HTML>