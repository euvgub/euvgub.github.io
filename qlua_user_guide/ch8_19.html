<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<HTML><HEAD><title>Функции для работы с графиками</title>
<META name=GENERATOR content="MSHTML 8.00.6001.18812">
<META content="text/html; charset=utf-8" http-equiv=Content-Type>

<STYLE type=text/css>

ADDRESS {font-style:normal;  padding-left: 20px; margin: 0px 0px 25pt 5pt; font-size: 9pt; color:#000000; font-style:normal; font-weight: normal; display:list-item; list-style-type:none; list-style-position: outside; list-style-image:url('template/icon-popup.gif');}

ADDRESS P {font-style:normal;  padding-left: 20px; margin: 0px 0px 5pt -15pt; font-size: 9pt; color:#000000; font-style:normal; font-weight: normal; display:list-item; list-style-type:none; list-style-position: outside; list-style-image:url('template/icon-popup.gif');}

MENU { font-size: 12pt; font-family:Verdana;  line-height:100%; margin:0px 0px 0px 20pt; list-style-type:none; list-style-position: outside; list-style-image:url('template/blt-link_black.gif'); }

BODY {font-family: Arial; font-size: 12pt; color:#000000; background-color: #fbfbfb; line-height: 1.3; margin:0pt 5pt 10pt 5pt;}

A {color: #16A9D3;}
P  {font-family:Arial; font-size:12pt; margin-top:0px; margin-bottom:12pt;}

IMG { margin:0pt 0pt 0pt auto; }

UL { font-family: Arial; font-size: 12pt; margin:12px 0px 12px 20px; list-style-type:disc; list-style-image:url('template/blt-li.gif'); } 
OL {font-family: Arial; font-size: 12pt; font-weight: bold; margin-top:12pt; margin-bottom:6pt; margin-left:20pt; type: bold;}
LI { margin-bottom: 8px; }
LI OL { margin-left: 25px; }
LI UL { margin-left: 25px; list-style-image:url('template/blt-link_black.gif'); }

SPAN {font-weight: normal;}

DD OL { font:12pt Verdana; font-style:normal; font-weight: bold; margin-left: 35px; }

H1 { font-size: 28pt; font-family:Verdana; color:#000000; font-style:normal; line-height:110%; margin-top:20pt; margin-bottom:26pt; text-decoration:none; font-weight: bold; margin-right:auto; margin-left:auto;}
H2 { font-size: 20pt; font-family:Verdana; color:#000000; font-style:normal; line-height:110%; margin-top:20pt; margin-bottom:6pt; text-decoration:none; font-weight: bold; margin-left:auto; padding: 0.5ex 0; }
H3 { font-size: 14pt; font-family:Verdana; color:#000000; font-style:normal; line-height:95%; margin-top:20pt; margin-bottom:6pt; margin-left: auto;}
H4 { font-size: 11pt; font-family:Verdana; color:#000000; font-style:normal; line-height:95%; margin-top:16pt; margin-bottom:6pt; margin-left: auto;}

TABLE { border-collapse: collapse; margin-bottom:20pt; }
TH { font-size: 10pt; border-top: none; border-bottom:#000000 3px solid; padding:15pt 5pt 5px 0px; color:#000000; font-family:Verdana; font-style:normal; font-weight: bold; text-align:left; }
TD { font-size:10pt; border-top: 0pt; font-family:Arial; border-bottom:#000000 1px solid; padding:4pt 5px 12pt 0px;  line-height:120%; }
TD P {font-family: Arial; font-size: 10pt; margin-top:6pt;}
TD.plain 	{margin:0px 0px 0px 0px; border-top: 0px; border-bottom:0px; padding:0px 0px 0px 0px; font-size:100%; line-height:100%;}
TD.array	{ border: 1px solid #D4D4D4; text-align: center; width: 90px;}
TD.pic	{ padding:0px 0px 0px 0px; }
TD.line1          { background-color:#000000; }
TD.line2          { background-color:#000000; }
TD UL {font-family: Arial; font-size: 10pt; margin:0px 0px 0px 20px; line-height:120%;}
TD UL LI {font-family: Arial; font-size: 10pt; margin-bottom: 0px; list-style-image:url('template/blt-link_black.gif');}

TD H4	{line-height: 100%; margin-top: 8px; margin-bottom: 0px;}

DL	{ padding-left:35px; margin-left: 30px; margin-bottom: 35px;}
DD	{ padding-left:8px; color:#000000; margin: 8px 8px 8px 0px; font:12pt Verdana; font-style:normal; font-weight: bold; border-left: #000000 4px solid; margin-bottom:18pt; }
DD P	{font:12pt Verdana; font-style:normal; font-weight: bold; }

PRE	{ background-color:#F2F2F2; margin-left: 35px; margin-bottom: 20px; border-style:none; border-top-style: none; border-bottom-style: none; padding:8px 8px 8px 8px; font: 10pt Courier New; line-height:160%;}

.title {display: inline; background:#FbFbFb; margin-left: 0px; border-style:solid; border-color:#D4D4D4; border-width: 1px 1px 0px 4px; padding:8px 8px 6px 12px; color:#19A788; font-weight:bold;}
.hlt { background:#FFFFFF; margin-left: 0px; border-style:solid; border-color:#D4D4D4; border-width: 1px 2px 1px 4px; padding:15px 8px 15px 46px;}

STRONG { font-weight: bold;}
.logo	{ position: relative; top:-45px; float: right; width: 100px; margin:10px 10px 10px 10px; }
.mark	{ font: 10pt Verdana; color: #5EB28E; }
.defn	{ font: 15px Trebuchet MS; margin:12px 0px 12px 50px; }
.copyright {font: 12pt Trebuchet MS; font-style:normal; color:#A2A2A2; margin-top: 50px;}
.comment	{ font-size: 10pt; font-family: Verdana; }
</STYLE>

<meta name=GENERATOR content="MSHTML 8.00.6001.18812"></head>
<body aLink=#19a788 link=#007cae vLink=#8d4194>
<H1 style="MARGIN-TOP: 10pt">Функции для работы с графиками</H1>
<P><FONT size=2 face=Arial>
<P>
<MENU>
  <LI><A href="#subt1">GET_CANDLE</A> 
  <LI><A href="#subt2">GET_CANDLE_EX</A> </LI></MENU>

<P>&nbsp;</P>
<A name=subt1></A>
<H2> GET_CANDLE</H2>
<P>Функция для обращения к данным «свечек» на графике, а также к значениям 
индикаторов технического анализа. </P>
<P class=defn>MAP&nbsp; GET_CANDLE (STRING&nbsp;class_code, 
STRING&nbsp;sec_code, STRING&nbsp;parameter_name, STRING&nbsp;interval, 
STRING&nbsp;graph_type, DOUBLE&nbsp;Date, DOUBLE&nbsp;Time)</P>
<P> Функция возвращает ассоциативный массив (MAP), содержащий информацию 
о ценах&nbsp; в момент времени «Date»«Time», для графика, построенного по&nbsp;инструменту с 
кодом «sec_code» из класса с кодом «class_code» с временным интервалом 
«interval». Если «class_code» равен «», то функция ищет «sec_code» по всем 
классам до первого нахождения. </P>
<P>Тип графика указывается следующим кодом: </P>
<P>
<TABLE>
  <TBODY>
  <TR>
    <TH>Тип графика</TH>
    <TH>Код</TH>
    <TD class=plain rowSpan=10 width12>&nbsp;</TD>
    <TH>Тип графика</TH>
    <TH>Код</TH>
    <TD class=plain rowSpan=10 width12>&nbsp;</TD>
    <TH>Тип графика</TH>
    <TH>Код</TH></TR>
  <TR>
    <TD>PRICE</TD>
    <TD>1</TD>
    <TD>PARABOLIC SAR</TD>
    <TD>10</TD>
    <TD>CUM AD&nbsp;</TD>
    <TD>21</TD></TR>
  <TR>
    <TD>VOLUME</TD>
    <TD>2</TD>
    <TD>SROC</TD>
    <TD>11</TD>
    <TD>CHAIKIN OSCILLATOR</TD>
    <TD>22</TD></TR>
  <TR>
    <TD>MOVING AVERAGE</TD>
    <TD>3</TD>
    <TD>MOM</TD>
    <TD>12</TD>
    <TD>CUM WAD</TD>
    <TD>23</TD></TR>
  <TR>
    <TD>PRICE OSCILLATOR</TD>
    <TD>4</TD>
    <TD>ROC</TD>
    <TD>13</TD>
    <TD>ELDER FI</TD>
    <TD>24</TD></TR>
  <TR>
    <TD>MACD</TD>
    <TD>5</TD>
    <TD>MFI</TD>
    <TD>16</TD>
    <TD>ELDER RAY</TD>
    <TD>25</TD></TR>
  <TR>
    <TD>STANDARD DEV</TD>
    <TD>6</TD>
    <TD>WILLIAMS %R</TD>
    <TD>17</TD>
    <TD>VERTICAL HORIZONTAL FILTER</TD>
    <TD>26</TD></TR>
  <TR>
    <TD>BOLLINGER LINES</TD>
    <TD>7</TD>
    <TD>ENVELOPS</TD>
    <TD>18</TD>
    <TD>CHAIKIN VOLATILITY</TD>
    <TD>27</TD></TR>
  <TR>
    <TD>STOCHASTIC</TD>
    <TD>8</TD>
    <TD>VOLUME OSCILLATOR</TD>
    <TD>19</TD>
    <TD>&nbsp;</TD>
    <TD>&nbsp;</TD></TR>
  <TR>
    <TD>RSI</TD>
    <TD>9</TD>
    <TD>BALANCE VOLUME</TD>
    <TD>20</TD>
    <TD>&nbsp;</TD>
    <TD>&nbsp;</TD></TR></TBODY></TABLE></P>
<P>&nbsp;</P>
<P>Значение временного интервала «interval» можно задавать следующими числовыми 
величинами:</P>
<P>
<TABLE>
  <TBODY>
  <TR>
    <TH>Величина интервала</TH>
    <TH>Значение</TH>
    <TD class=plain rowSpan=8 width12>&nbsp;</TD>
    <TH>Величина интервала</TH>
    <TH>Значение</TH>
    <TD class=plain rowSpan=8 width12>&nbsp;</TD>
    <TH>Величина интервала</TH>
    <TH>Значение</TH></TR>
  <TR>
    <TD rowSpan=2>Месячный</TD>
    <TD>month</TD>
    <TD>1 минута</TD>
    <TD>1</TD>
    <TD>15 минут</TD>
    <TD>15</TD></TR>
  <TR>
    <TD>-3</TD>
    <TD>&nbsp;</TD>
    <TD>2</TD>
    <TD>20 минут</TD>
    <TD>20</TD></TR>
  <TR>
    <TD rowSpan=2>Недельный</TD>
    <TD>week</TD>
    <TD>3 минуты</TD>
    <TD>3</TD>
    <TD>30 минут</TD>
    <TD>30</TD></TR>
  <TR>
    <TD>-2</TD>
    <TD>4 минуты</TD>
    <TD>4</TD>
    <TD>60 минут</TD>
    <TD>60</TD></TR>
  <TR>
    <TD rowSpan=2>Дневной</TD>
    <TD>day</TD>
    <TD>5 минут</TD>
    <TD>5</TD>
    <TD>2 часа</TD>
    <TD>120</TD></TR>
  <TR>
    <TD>-1</TD>
    <TD>6 минут</TD>
    <TD>6</TD>
    <TD>4 часа</TD>
    <TD>240</TD></TR>
  <TR>
    <TD>Тиковый</TD>
    <TD>0</TD>
    <TD>10 минут</TD>
    <TD>10</TD>
    <TD>&nbsp;</TD>
    <TD>&nbsp;</TD></TR></TBODY></TABLE></P>
<P>&nbsp;</P>
<P>Значение «parameter_name» должно соответствовать одному из значений имени 
параметра из Таблицы текущих значений параметров. Их перечень см. <A 
href="ch8_12.html"> Функции для получения значений Таблицы текущих 
торгов</A>. Если «parameter_name» указан как «», то поиск осуществляется по 
данным Таблицы обезличенных сделок. </P>
<P>Значение даты «Date» нужно указывать в формате «ГГГГММДД». Например, 
«20050527» означает 27 мая 2005 г. Значение времени «Time» нужно указывать в 
формате «ЧЧММСС». Например, «163500» означает 16 ч. 35 мин. <BR>Функция 
возвращает ассоциативный массив (MAP), содержащий параметры:</P>
<P>
<TABLE width="100%">
  <TBODY>
  <TR>
    <TH>№</TH>
    <TH>Параметр</TH>
    <TH>Тип</TH>
    <TH>Описание</TH></TR>
  <TR>
    <TD>1</TD>
    <TD>OPEN</TD>
    <TD>DOUBLE</TD>
    <TD>Цена открытия (первой сделки) в данном интервале времени</TD></TR>
  <TR>
    <TD>2</TD>
    <TD>CLOSE</TD>
    <TD>DOUBLE</TD>
    <TD>Цена закрытия (последней сделки) в интервале</TD></TR>
  <TR>
    <TD>3</TD>
    <TD>HIGH</TD>
    <TD>DOUBLE</TD>
    <TD>Наибольшая цена сделки в интервале</TD></TR>
  <TR>
    <TD>4</TD>
    <TD>LOW</TD>
    <TD>DOUBLE</TD>
    <TD>Наименьшая цена сделки в интервале</TD></TR>
  <TR>
    <TD>5</TD>
    <TD>VOLUME</TD>
    <TD>DOUBLE</TD>
    <TD>Суммарный объем сделок в интервале </TD></TR></TBODY></TABLE></P>
<H3>Пример: </H3><PRE>‘<BR>msg = GET_CANDLE("TQBR", "HYDR", "", "5", "PRICE", 20101130, 103500) 
<BR>MESSAGE(msg, 2)<BR>‘</PRE><A name=subt2></A>
<H2>  GET_CANDLE_EX</H2>
<P>В некоторых случаях, например, когда индикатор технического анализа состоит 
из нескольких линий, применение функции GET CANDLE невозможно. Для доступа к 
таким&nbsp;графикам средствами языка QPILE&nbsp;используется функция GET CANDLE 
EX.</P>
<P class=defn>MAP&nbsp; GET_CANDLE_EX (STRING Tag, DOUBLE Date, DOUBLE Time) 
</P>
<P>Функция возвращает ассоциативный массив (MAP) с данными для графика со 
строковым идентификатором Tag в момент времени «Date» и «Time». Таким образом, 
для того чтобы обратиться к данным на графике, необходимо его предварительно 
построить и присвоить ему уникальный строковый идентификатор Tag. Идентификатор 
Tag задается в диалоге «Редактирование настроек графика» на вкладке «<A href="ch4_2_3.html#subt1">Дополнительно</A>». </P>
<P>При вызове функции значение даты «Date» нужно указывать в формате «ГГГГММДД». 
Например, «20050527» означает 27&nbsp;мая 2005 г. Значение времени «Time» нужно 
указывать в формате «ЧЧММСС». Например, «163500» означает 16&nbsp;ч. 
35&nbsp;мин. Функция округляет параметр «Time» до ближайшего меньшего значения 
времени, соответствующего интервалу графика. Например, если интервал графика — 
«5 минут», а значение параметра «Time» — «163700», то функция округлит значения 
параметр «Time» до «163500», а если интервал графика – «60 минут», то «163700» 
округлиться до «160000».</P>
<P>Возвращаемый функцией ассоциативный массив содержит следующие поля:</P>
<P>
<TABLE width="100%">
  <TBODY>
  <TR>
    <TH>№</TH>
    <TH>Параметр</TH>
    <TH>Тип</TH>
    <TH>Описание</TH></TR>
  <TR>
    <TD>1</TD>
    <TD>COUNT</TD>
    <TD>DOUBLE</TD>
    <TD>Количество линий, образующих индикатор</TD></TR>
  <TR>
    <TD>2</TD>
    <TD>TIME</TD>
    <TD>DOUBLE</TD>
    <TD>Точное время свечки</TD></TR>
  <TR>
    <TD>3</TD>
    <TD>LINES</TD>
    <TD>DOUBLE</TD>
    <TD>Коллекция линий, в которой каждый элемент коллекции содержит 
      ассоциативный массив (MAP)</TD></TR></TBODY></TABLE></P>
<P>&nbsp;</P>
<P>Каждый элемент коллекции линий содержит ассоциативный массив (MAP) со 
следующими параметрами:</P>
<P>
<TABLE width="100%">
  <TBODY>
  <TR>
    <TH>№</TH>
    <TH>Параметр</TH>
    <TH>Тип</TH>
    <TH>Описание</TH></TR>
  <TR>
    <TD>1</TD>
    <TD>NAME</TD>
    <TD>STRING</TD>
    <TD>Название линии (из легенды)</TD></TR>
  <TR>
    <TD>2</TD>
    <TD>OPEN</TD>
    <TD>DOUBLE</TD>
    <TD>Цена открытия в интервале времени</TD></TR>
  <TR>
    <TD>3</TD>
    <TD>CLOSE</TD>
    <TD>DOUBLE</TD>
    <TD>Цена закрытия в интервале времени</TD></TR>
  <TR>
    <TD>4</TD>
    <TD>HIGH</TD>
    <TD>DOUBLE</TD>
    <TD>Наибольшее значение цены в интервале времени</TD></TR>
  <TR>
    <TD>5</TD>
    <TD>LOW</TD>
    <TD>DOUBLE</TD>
    <TD>Наименьшее значение цены в интервале времени</TD></TR>
  <TR>
    <TD>6</TD>
    <TD>VOLUME</TD>
    <TD>DOUBLE</TD>
    <TD>Суммарный объем сделок в интервале</TD></TR></TBODY></TABLE></P>
<H3>Пример:</H3><PRE>slice = Get_Candle_Ex ("all", 20070511, 170000) 
<BR>LineCount = Get_Value (slice,"COUNT") <BR>time = Get_Value (slice,"TIME") 
<BR>lines = Get_Value (slice,"LINES") <BR>FOR lineID FROM 0 TO LineCount-1 
<BR>line = Get_Collection_Item (lines, lineID) <BR>open = Get_Value (line,"OPEN") 
<BR>line_name = Get_Value (line,"NAME")
<BR>volume = Get_Value (line,"VOLUME")
<BR>END FOR<BR></PRE>

</FONT></P>

<P><DIV class=copyright>Руководство пользователя QUIK © ARQA Technologies / <A 
href="http://arqatech.com/ru/products/quik/" target="_blank">www.arqatech.com/ru/products/quik/ </A></DIV>
</body>
</HTML>