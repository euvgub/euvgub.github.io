<!DOCTYPE html >
<html lang="en">
<head>
<meta http-equiv="X-UA-Compatible" content="IE=Edge" />
<meta charset="utf-8" />
</head>

<body style="margin: 0;">

<div id="p30" style="overflow: hidden; position: relative; background-color: white; width: 909px; height: 1286px;">

<!-- Begin shared CSS values -->
<style class="shared-css" type="text/css" >
.t {
	-webkit-transform-origin: bottom left;
	-ms-transform-origin: bottom left;
	transform-origin: bottom left;
	-webkit-transform: scale(0.25);
	-ms-transform: scale(0.25);
	transform: scale(0.25);
	z-index: 2;
	position: absolute;
	white-space: pre;
	overflow: visible;
}
</style>
<!-- End shared CSS values -->


<!-- Begin inline CSS -->
<style type="text/css" >

#t1_30{left:811px;bottom:54px;letter-spacing:0.3px;}
#t2_30{left:175px;bottom:69px;letter-spacing:-0.2px;word-spacing:-0.2px;}
#t3_30{left:538px;bottom:69px;letter-spacing:-0.2px;}
#t4_30{left:88px;bottom:1171px;letter-spacing:0.2px;}
#t5_30{left:142px;bottom:1171px;letter-spacing:-0.1px;word-spacing:-0.1px;}
#t6_30{left:587px;bottom:1171px;}
#t7_30{left:659px;bottom:1171px;letter-spacing:-0.2px;}
#t8_30{left:88px;bottom:1125px;letter-spacing:0.1px;}
#t9_30{left:373px;bottom:1125px;letter-spacing:0.1px;}
#ta_30{left:416px;bottom:1125px;letter-spacing:0.1px;word-spacing:-0.1px;}
#tb_30{left:503px;bottom:1125px;letter-spacing:0.1px;}
#tc_30{left:535px;bottom:1125px;letter-spacing:0.1px;}
#td_30{left:592px;bottom:1125px;letter-spacing:0.2px;}
#te_30{left:636px;bottom:1125px;letter-spacing:0.1px;word-spacing:0.6px;}
#tf_30{left:88px;bottom:1100px;letter-spacing:0.1px;}
#tg_30{left:223px;bottom:1100px;letter-spacing:0.1px;word-spacing:-0.1px;}
#th_30{left:735px;bottom:1100px;letter-spacing:0.3px;}
#ti_30{left:88px;bottom:1074px;letter-spacing:0.1px;word-spacing:0.6px;}
#tj_30{left:308px;bottom:1074px;letter-spacing:0.1px;}
#tk_30{left:423px;bottom:1074px;letter-spacing:0.1px;word-spacing:0.2px;}
#tl_30{left:88px;bottom:1048px;letter-spacing:0.1px;word-spacing:0.4px;}
#tm_30{left:88px;bottom:1007px;letter-spacing:0.1px;}
#tn_30{left:171px;bottom:1007px;letter-spacing:0.2px;}
#to_30{left:88px;bottom:968px;letter-spacing:0.1px;}
#tp_30{left:160px;bottom:968px;letter-spacing:0.1px;}
#tq_30{left:299px;bottom:968px;letter-spacing:0.1px;word-spacing:0.2px;}
#tr_30{left:624px;bottom:968px;letter-spacing:0.2px;word-spacing:-0.4px;}
#ts_30{left:668px;bottom:968px;letter-spacing:0.1px;}
#tt_30{left:88px;bottom:942px;letter-spacing:0.1px;}
#tu_30{left:505px;bottom:942px;letter-spacing:0.2px;word-spacing:-0.2px;}
#tv_30{left:599px;bottom:942px;letter-spacing:0.3px;}
#tw_30{left:646px;bottom:942px;letter-spacing:0.1px;word-spacing:0.4px;}
#tx_30{left:738px;bottom:942px;letter-spacing:0.1px;}
#ty_30{left:88px;bottom:916px;letter-spacing:0.1px;word-spacing:0.2px;}
#tz_30{left:300px;bottom:916px;letter-spacing:0.1px;word-spacing:0.1px;}
#t10_30{left:583px;bottom:916px;letter-spacing:0.1px;}
#t11_30{left:630px;bottom:916px;letter-spacing:0.2px;}
#t12_30{left:728px;bottom:916px;letter-spacing:0.2px;}
#t13_30{left:88px;bottom:891px;letter-spacing:0.1px;}
#t14_30{left:147px;bottom:891px;letter-spacing:0.3px;}
#t15_30{left:99px;bottom:837px;}
#t16_30{left:198px;bottom:837px;}
#t17_30{left:297px;bottom:837px;}
#t18_30{left:363px;bottom:837px;}
#t19_30{left:223px;bottom:814px;}
#t1a_30{left:280px;bottom:814px;}
#t1b_30{left:371px;bottom:814px;}
#t1c_30{left:223px;bottom:791px;}
#t1d_30{left:305px;bottom:791px;}
#t1e_30{left:355px;bottom:791px;}
#t1f_30{left:223px;bottom:768px;}
#t1g_30{left:289px;bottom:768px;}
#t1h_30{left:404px;bottom:768px;}
#t1i_30{left:223px;bottom:745px;}
#t1j_30{left:322px;bottom:745px;}
#t1k_30{left:355px;bottom:745px;}
#t1l_30{left:223px;bottom:722px;}
#t1m_30{left:289px;bottom:722px;}
#t1n_30{left:338px;bottom:722px;}
#t1o_30{left:223px;bottom:699px;}
#t1p_30{left:305px;bottom:699px;}
#t1q_30{left:330px;bottom:699px;}
#t1r_30{left:223px;bottom:676px;}
#t1s_30{left:272px;bottom:676px;}
#t1t_30{left:338px;bottom:676px;}
#t1u_30{left:223px;bottom:653px;}
#t1v_30{left:297px;bottom:653px;}
#t1w_30{left:338px;bottom:653px;}
#t1x_30{left:223px;bottom:630px;}
#t1y_30{left:264px;bottom:630px;}
#t1z_30{left:289px;bottom:630px;}
#t20_30{left:99px;bottom:584px;}
#t21_30{left:157px;bottom:584px;}
#t22_30{left:173px;bottom:584px;}
#t23_30{left:297px;bottom:584px;}
#t24_30{left:305px;bottom:584px;}
#t25_30{left:396px;bottom:584px;}
#t26_30{left:99px;bottom:539px;}
#t27_30{left:124px;bottom:539px;}
#t28_30{left:181px;bottom:539px;}
#t29_30{left:206px;bottom:539px;}
#t2a_30{left:231px;bottom:539px;}
#t2b_30{left:115px;bottom:516px;}
#t2c_30{left:173px;bottom:516px;}
#t2d_30{left:181px;bottom:516px;}
#t2e_30{left:231px;bottom:516px;}
#t2f_30{left:297px;bottom:516px;}
#t2g_30{left:305px;bottom:516px;}
#t2h_30{left:396px;bottom:516px;}
#t2i_30{left:421px;bottom:516px;}
#t2j_30{left:445px;bottom:516px;}
#t2k_30{left:503px;bottom:516px;}
#t2l_30{left:577px;bottom:516px;}
#t2m_30{left:602px;bottom:516px;}
#t2n_30{left:668px;bottom:516px;}
#t2o_30{left:751px;bottom:516px;}
#t2p_30{left:833px;bottom:516px;}
#t2q_30{left:297px;bottom:493px;}
#t2r_30{left:388px;bottom:493px;}
#t2s_30{left:478px;bottom:493px;}
#t2t_30{left:528px;bottom:493px;}
#t2u_30{left:99px;bottom:470px;}
#t2v_30{left:115px;bottom:447px;}
#t2w_30{left:173px;bottom:447px;}
#t2x_30{left:181px;bottom:447px;}
#t2y_30{left:231px;bottom:447px;}
#t2z_30{left:297px;bottom:447px;}
#t30_30{left:305px;bottom:447px;}
#t31_30{left:396px;bottom:447px;}
#t32_30{left:421px;bottom:447px;}
#t33_30{left:503px;bottom:447px;}
#t34_30{left:511px;bottom:447px;}
#t35_30{left:297px;bottom:424px;}
#t36_30{left:388px;bottom:424px;}
#t37_30{left:99px;bottom:401px;}
#t38_30{left:88px;bottom:329px;letter-spacing:0.1px;}
#t39_30{left:279px;bottom:329px;letter-spacing:0.1px;}
#t3a_30{left:311px;bottom:329px;letter-spacing:0.2px;}
#t3b_30{left:381px;bottom:329px;letter-spacing:0.1px;}
#t3c_30{left:470px;bottom:329px;letter-spacing:0.1px;word-spacing:0.3px;}
#t3d_30{left:623px;bottom:329px;letter-spacing:0.4px;}
#t3e_30{left:646px;bottom:329px;word-spacing:0.2px;}
#t3f_30{left:88px;bottom:303px;letter-spacing:0.1px;word-spacing:0.1px;}
#t3g_30{left:431px;bottom:303px;letter-spacing:0.1px;}
#t3h_30{left:454px;bottom:303px;letter-spacing:0.1px;word-spacing:0.3px;}
#t3i_30{left:717px;bottom:303px;letter-spacing:0.2px;word-spacing:-0.2px;}
#t3j_30{left:88px;bottom:278px;letter-spacing:0.1px;word-spacing:0.1px;}
#t3k_30{left:740px;bottom:278px;letter-spacing:0.1px;}
#t3l_30{left:88px;bottom:252px;letter-spacing:0.1px;word-spacing:0.1px;}
#t3m_30{left:272px;bottom:252px;letter-spacing:-0.2px;}
#t3n_30{left:283px;bottom:252px;letter-spacing:0.1px;word-spacing:0.4px;}
#t3o_30{left:88px;bottom:226px;letter-spacing:0.1px;word-spacing:-0.1px;}
#t3p_30{left:496px;bottom:226px;letter-spacing:0.1px;}
#t3q_30{left:88px;bottom:200px;}

.s1_30{
	FONT-SIZE: 97.5px;
	FONT-FAMILY: Verdana-Bold_k;
	color: rgb(0,0,0);
}

.s2_30{
	FONT-SIZE: 67.5px;
	FONT-FAMILY: Verdana-Bold_j;
	color: rgb(128,128,128);
}

.s3_30{
	FONT-SIZE: 67.5px;
	FONT-FAMILY: Verdana-Bold_k;
	color: rgb(128,128,128);
}

.s4_30{
	FONT-SIZE: 122.5px;
	FONT-FAMILY: Verdana-Bold_k;
	color: rgb(0,0,0);
}

.s5_30{
	FONT-SIZE: 122.5px;
	FONT-FAMILY: Verdana-Bold_j;
	color: rgb(0,0,0);
}

.s6_30{
	FONT-SIZE: 60.9px;
	FONT-FAMILY: PTSansCaption_w;
	color: rgb(0,0,0);
}

.s7_30{
	FONT-SIZE: 60.9px;
	FONT-FAMILY: PTSansCaption_9;
	color: rgb(0,0,0);
}

.s8_30{
	FONT-SIZE: 60.9px;
	FONT-FAMILY: PTSansCaption-Bold_2q;
	color: rgb(0,0,0);
}

.s9_30{
	FONT-SIZE: 60.9px;
	FONT-FAMILY: Verdana-Bold_j;
	color: rgb(0,0,0);
}

.s10_30{
	FONT-SIZE: 60.9px;
	FONT-FAMILY: Verdana-Bold_k;
	color: rgb(0,0,0);
}

.s11_30{
	FONT-SIZE: 55px;
	FONT-FAMILY: CourierNew-Bold_32;
	color: rgb(0,0,0);
}

.s12_30{
	FONT-SIZE: 55px;
	FONT-FAMILY: CourierNew_2x;
	color: rgb(0,0,0);
}

.s13_30{
	FONT-SIZE: 55px;
	FONT-FAMILY: CourierNew_2x;
	color: rgb(42,0,255);
}

.s14_30{
	FONT-SIZE: 55px;
	FONT-FAMILY: CourierNew-Bold_32;
	color: rgb(127,0,85);
}

.s15_30{
	FONT-SIZE: 55px;
	FONT-FAMILY: CourierNew_31;
	color: rgb(42,0,255);
}

</style>
<!-- End inline CSS -->

<!-- Begin embedded font definitions -->
<style id="fonts30" type="text/css" >

@font-face {
	font-family: CourierNew-Bold_32;
	src: url("fonts/CourierNew-Bold_32.woff") format("woff");
}

@font-face {
	font-family: CourierNew_2x;
	src: url("fonts/CourierNew_2x.woff") format("woff");
}

@font-face {
	font-family: CourierNew_31;
	src: url("fonts/CourierNew_31.woff") format("woff");
}

@font-face {
	font-family: PTSansCaption-Bold_2q;
	src: url("fonts/PTSansCaption-Bold_2q.woff") format("woff");
}

@font-face {
	font-family: PTSansCaption_9;
	src: url("fonts/PTSansCaption_9.woff") format("woff");
}

@font-face {
	font-family: PTSansCaption_w;
	src: url("fonts/PTSansCaption_w.woff") format("woff");
}

@font-face {
	font-family: Verdana-Bold_j;
	src: url("fonts/Verdana-Bold_j.woff") format("woff");
}

@font-face {
	font-family: Verdana-Bold_k;
	src: url("fonts/Verdana-Bold_k.woff") format("woff");
}

</style>
<!-- End embedded font definitions -->

<!-- Begin page background -->
<div id="pg30Overlay" style="width:100%; height:100%; position:absolute; z-index:1; background-color:rgba(0,0,0,0); -webkit-user-select: none;"></div>
<div id="pg30" style="-webkit-user-select: none;"><object width="909" height="1286" data="30/30.svg" type="image/svg+xml" id="pdf30" style="width:909px; height:1286px; -moz-transform:scale(1); z-index: 0;"></object></div>
<!-- End page background -->


<!-- Begin text definitions (Positioned/styled in CSS) -->
<div id="t1_30" class="t s1_30">30</div>
<div id="t2_30" class="t s2_30">Использование Lua в Рабочем месте</div>
<div id="t3_30" class="t s3_30">QUIK </div>
<div id="t4_30" class="t s4_30">4.</div>
<div id="t5_30" class="t s5_30">Отправка транзакций из</div>
<div id="t6_30" class="t s4_30">Lua </div>
<div id="t7_30" class="t s5_30">скрипта</div>
<div id="t8_30" class="t s6_30">Для отправки транзакций на сервер </div>
<div id="t9_30" class="t s7_30">QUIK </div>
<div id="ta_30" class="t s6_30">из скрипта </div>
<div id="tb_30" class="t s7_30">Lua </div>
<div id="tc_30" class="t s6_30">плагин </div>
<div id="td_30" class="t s7_30">QLua </div>
<div id="te_30" class="t s6_30">предоставляет функцию </div>
<div id="tf_30" class="t s8_30">sendTransaction()</div>
<div id="tg_30" class="t s6_30">, а для получения результата выполнения транзакции на сервере </div>
<div id="th_30" class="t s7_30">QUIK </div>
<div id="ti_30" class="t s6_30">функцию обратного вызова </div>
<div id="tj_30" class="t s8_30">OnTransReply()</div>
<div id="tk_30" class="t s6_30">. Рассмотрим структуру данных функций и способы </div>
<div id="tl_30" class="t s6_30">их использования.</div>
<div id="tm_30" class="t s9_30">Функция </div>
<div id="tn_30" class="t s10_30">sendTransaction() </div>
<div id="to_30" class="t s6_30">Функция </div>
<div id="tp_30" class="t s8_30">sendTransaction()</div>
<div id="tq_30" class="t s6_30">принимает в качестве аргумента таблицу </div>
<div id="tr_30" class="t s7_30">Lua c </div>
<div id="ts_30" class="t s6_30">параметрами </div>
<div id="tt_30" class="t s6_30">транзакции. Если транзакция не прошла проверку на</div>
<div id="tu_30" class="t s6_30">стороне РМ </div>
<div id="tv_30" class="t s7_30">QUIK, </div>
<div id="tw_30" class="t s6_30">то функция</div>
<div id="tx_30" class="t s6_30">возвращает </div>
<div id="ty_30" class="t s6_30">описание ошибки, иначе –</div>
<div id="tz_30" class="t s6_30">транзакция отправляется на сервер </div>
<div id="t10_30" class="t s7_30">QUIK. </div>
<div id="t11_30" class="t s6_30">Рассмотрим</div>
<div id="t12_30" class="t s6_30">следующий</div>
<div id="t13_30" class="t s6_30">пример</div>
<div id="t14_30" class="t s7_30">: </div>
<div id="t15_30" class="t s11_30">transaction</div>
<div id="t16_30" class="t s12_30">= {TRANS_ID=</div>
<div id="t17_30" class="t s13_30">'400001'</div>
<div id="t18_30" class="t s12_30">, </div>
<div id="t19_30" class="t s12_30">ACTION=</div>
<div id="t1a_30" class="t s13_30">'NEW_ORDER'</div>
<div id="t1b_30" class="t s12_30">, </div>
<div id="t1c_30" class="t s12_30">CLASSCODE=</div>
<div id="t1d_30" class="t s13_30">'TQBR'</div>
<div id="t1e_30" class="t s12_30">, </div>
<div id="t1f_30" class="t s12_30">ACCOUNT=</div>
<div id="t1g_30" class="t s13_30">'L01-00XXXXXX'</div>
<div id="t1h_30" class="t s12_30">, </div>
<div id="t1i_30" class="t s12_30">CLIENT_CODE=</div>
<div id="t1j_30" class="t s13_30">'QX'</div>
<div id="t1k_30" class="t s12_30">, </div>
<div id="t1l_30" class="t s12_30">SECCODE=</div>
<div id="t1m_30" class="t s13_30">'LKOH'</div>
<div id="t1n_30" class="t s12_30">, </div>
<div id="t1o_30" class="t s12_30">OPERATION=</div>
<div id="t1p_30" class="t s13_30">'B'</div>
<div id="t1q_30" class="t s12_30">, </div>
<div id="t1r_30" class="t s12_30">PRICE=</div>
<div id="t1s_30" class="t s13_30">'2650.5'</div>
<div id="t1t_30" class="t s12_30">, </div>
<div id="t1u_30" class="t s12_30">QUANTITY=</div>
<div id="t1v_30" class="t s13_30">'300'</div>
<div id="t1w_30" class="t s12_30">, </div>
<div id="t1x_30" class="t s12_30">TYPE=</div>
<div id="t1y_30" class="t s13_30">'L'</div>
<div id="t1z_30" class="t s12_30">} </div>
<div id="t20_30" class="t s11_30">result</div>
<div id="t21_30" class="t s12_30">= </div>
<div id="t22_30" class="t s11_30">sendTransaction</div>
<div id="t23_30" class="t s12_30">(</div>
<div id="t24_30" class="t s11_30">transaction</div>
<div id="t25_30" class="t s12_30">) </div>
<div id="t26_30" class="t s14_30">if</div>
<div id="t27_30" class="t s11_30">result</div>
<div id="t28_30" class="t s12_30">~= </div>
<div id="t29_30" class="t s13_30">"" </div>
<div id="t2a_30" class="t s14_30">then</div>
<div id="t2b_30" class="t s11_30">message</div>
<div id="t2c_30" class="t s12_30">(</div>
<div id="t2d_30" class="t s11_30">string</div>
<div id="t2e_30" class="t s12_30">.format(</div>
<div id="t2f_30" class="t s13_30">"</div>
<div id="t2g_30" class="t s15_30">Транзакция</div>
<div id="t2h_30" class="t s13_30">%s </div>
<div id="t2i_30" class="t s15_30">не</div>
<div id="t2j_30" class="t s15_30">прошла</div>
<div id="t2k_30" class="t s15_30">проверку</div>
<div id="t2l_30" class="t s15_30">на</div>
<div id="t2m_30" class="t s15_30">стороне</div>
<div id="t2n_30" class="t s15_30">терминала</div>
<div id="t2o_30" class="t s13_30">QUIK [%s]"</div>
<div id="t2p_30" class="t s12_30">, </div>
<div id="t2q_30" class="t s11_30">transaction</div>
<div id="t2r_30" class="t s12_30">.TRANS_ID, </div>
<div id="t2s_30" class="t s11_30">result</div>
<div id="t2t_30" class="t s12_30">)) </div>
<div id="t2u_30" class="t s14_30">else</div>
<div id="t2v_30" class="t s11_30">message</div>
<div id="t2w_30" class="t s12_30">(</div>
<div id="t2x_30" class="t s11_30">string</div>
<div id="t2y_30" class="t s12_30">.format(</div>
<div id="t2z_30" class="t s13_30">"</div>
<div id="t30_30" class="t s15_30">Транзакция</div>
<div id="t31_30" class="t s13_30">%s </div>
<div id="t32_30" class="t s15_30">отправлена</div>
<div id="t33_30" class="t s13_30">"</div>
<div id="t34_30" class="t s12_30">, </div>
<div id="t35_30" class="t s11_30">transaction</div>
<div id="t36_30" class="t s12_30">.TRANS_ID)) </div>
<div id="t37_30" class="t s14_30">end</div>
<div id="t38_30" class="t s6_30">В данном примере поля </div>
<div id="t39_30" class="t s7_30">Lua </div>
<div id="t3a_30" class="t s6_30">таблицы </div>
<div id="t3b_30" class="t s8_30">transaction</div>
<div id="t3c_30" class="t s6_30">аналогичны полям .</div>
<div id="t3d_30" class="t s7_30">tri-</div>
<div id="t3e_30" class="t s6_30">файла с параметрами </div>
<div id="t3f_30" class="t s6_30">транзакций (подробное описание формата .</div>
<div id="t3g_30" class="t s7_30">tri-</div>
<div id="t3h_30" class="t s6_30">файла и примеры транзакций см.</div>
<div id="t3i_30" class="t s6_30">в Руководстве </div>
<div id="t3j_30" class="t s6_30">пользователя QUIK, раздел 6 «Совместная работа с другими приложениями», меню</div>
<div id="t3k_30" class="t s6_30">Импорт </div>
<div id="t3l_30" class="t s6_30">транзакций / Формат .tr</div>
<div id="t3m_30" class="t s7_30">i-</div>
<div id="t3n_30" class="t s6_30">файла с параметрами транзакций). При этом для корректной обработки </div>
<div id="t3o_30" class="t s6_30">данных числовые значения (цена, количество и т.д.)</div>
<div id="t3p_30" class="t s6_30">должны передаваться в виде строковых </div>
<div id="t3q_30" class="t s6_30">значений.</div>

<!-- End text definitions -->


</div>
</body>
</html>
